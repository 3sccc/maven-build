apply plugin: 'java'

allprojects {
    archivesBaseName = 'hello'

    sourceSets {
        main {
            java {
                srcDir 'src/main/java'
            }
        }
        test {
            java {
                srcDir 'src/test/java'
            }
        }
    }

    repositories {
        mavenCentral()
    }
    dependencies {
        implementation 'javax.xml.ws:jaxws-api:2.3.3'
    }
}

subprojects {
    apply plugin: 'java'
    
    dependencies {
        testImplementation 'junit:junit:4.13.2'
        implementation 'javax.xml.ws:jaxws-api:2.3.3'
    }

    tasks.register('hello') {
        doLast {
            test
        }
    }

    jar {
        manifest {
            attributes 'Main-Class': 'com.example.Main'
        }
        from sourceSets.main.output
    }

    tasks.register('createDistribution', Zip) {
        dependsOn 'jar'
        from jar
        archiveFileName = "hello-${project.version}.zip"
        into("$buildDir/distributions")
    }
}
