apply plugin: 'java'

allprojects {
    apply plugin: 'java'
    
    archivesBaseName = 'hello'
    
    sourceSets {
        main {
            java {
                srcDir 'src'
            }
        }
        test {
            java {
                srcDir 'src/test'
            }
        }
    }
    repositories {
        mavenCentral()
    }

    dependencies {
        testImplementation 'junit:junit:4.13.2' 
    }
    
}

subprojects {
    apply plugin: 'java'

    task hello(dependsOn: 'testcustom') {
        doLast {
            println "Hello task executed successfully!"
        }
    }

    task testcustom(dependsOn: 'build') {
        doLast {
            println "Custom test task executed!"
        }
    }

    task buildcustom(dependsOn: 'clean') {
        doLast {
            println "Custom build task executed!"
        }
    }
    
    jar {
        manifest {
            attributes 'Main-Class': 'com.example.Main'
        }
        from sourceSets.main.output
    }

    task createDistribution(type: Zip) {
        dependsOn 'jar'
        from jar
        archiveFileName = "hello-${project.version}.zip"
        into("$buildDir/distributions")
    }
}
